```{r}

activity<-read.csv("activity.csv")
```
##Imputing missing values

**Finding column which contains the NA values** 

```{r}
list_na <- colnames(activity)[ apply(activity, 2, anyNA) ]
```
The column with missing values is `r list_na`


**Number of missing Values**
```{r}

num_na<-sum(is.na(activity))

```
The number of missing values is `r num_na`


**Exclude missing values**
```{r}

na_drop<-na.omit(activity)		
na_drop
```


**Replacing the rows with missing values with the mean of steps**

```{r}
library(dplyr)
average_missing <- apply(activity[,colnames(activity) %in% list_na,drop=F],2,FUN= mean, na.rm =  TRUE)
average_missing

activity_replace <- activity %>%  mutate(replace_mean_step  = ifelse(is.na(steps), average_missing[1], steps)) 

activity_new = subset(activity_replace,select=-c(steps)) 
```


**Updated Dataset**
```{r}
activity_new = subset(activity_replace,select=-c(steps))
c_Act<-colnames(activity_new)
```
The new dataset includes `r c_Act`


**Histogram**
```{r histogram2}
steps_day_new<-tapply(activity_new$replace_mean_step,activity_new$date,sum,na.rm=TRUE)
par(mar=c(4,4,1,1))
hist(steps_day_new,col="dark blue",main = "Total number of steps taken per day",xlab="Number of steps",ylab="Frequency")
mean_step_new<-mean(steps_day_new)
median_step_new<-median(steps_day_new)
```
The new mean is `r mean_step_new`  
The new median is `r median_step_new`


##Activity patterns on weekdays and weekends

**Indicate whether a given data is a weekday or weekend-day**

```{r}
activity_new$wDay <- factor((weekdays(as.Date(activity_new$date)) %in% activity_new$wDay),levels=c(FALSE, TRUE), labels=c('weekend', 'weekday'))
```


**Time Series plot according to the type of day,i.e Weekday or Weekend**

```{r timeseries}
wDay.df <- activity_new %>% group_by(interval,wDay) %>% summarise(mean.step=mean(replace_mean_step))
library(ggplot2)


wDay_pattern <- ggplot(wDay.df, aes(x=interval, y=mean.step, color=wDay)) + 
        facet_grid(wDay~.) +
        geom_line() + 
        labs(title="Average Number of Steps Taken vs 5-min Interval on Weekday/Weekend", y="Average Number of Steps", x="5-min Interval Times Series")
wDay_pattern
```                  